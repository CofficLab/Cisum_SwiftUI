# Cisum è‡ªåŠ¨åŒ–ç‰ˆæœ¬ç®¡ç†

Cisum é¡¹ç›®ä½¿ç”¨ **Conventional Commits** è§„èŒƒç»“åˆ **Semantic Versioning** å®ç°è‡ªåŠ¨åŒ–ç‰ˆæœ¬ç®¡ç†ã€‚

## ğŸ¯ å·¥ä½œåŸç†

å½“ä»£ç æ¨é€åˆ° `main` æˆ– `pre` åˆ†æ”¯æ—¶ï¼ŒGitHub Actions ä¼šè‡ªåŠ¨ï¼š

1. åˆ†æè‡ªä¸Šæ¬¡æ ‡ç­¾ä»¥æ¥çš„æ‰€æœ‰æäº¤ä¿¡æ¯
2. æ ¹æ® Conventional Commits è§„èŒƒå†³å®šç‰ˆæœ¬å¢é‡ç±»å‹
3. è‡ªåŠ¨è®¡ç®—æ–°ç‰ˆæœ¬å·å¹¶æ›´æ–° Xcode é¡¹ç›®æ–‡ä»¶
4. åˆ›å»º Git æ ‡ç­¾å¹¶æ¨é€

## ğŸ“ Conventional Commits è§„èŒƒ

### æäº¤æ ¼å¼

```
<type>(<scope>): <subject>

[optional body]

[optional footer]
```

### ç‰ˆæœ¬å¢é‡è§„åˆ™

| æäº¤ç±»å‹ | ç‰ˆæœ¬å¢é‡ | ç¤ºä¾‹ |
|---------|---------|------|
| **Breaking Changes** | `major` | `feat!: breaking API change`<br>`fix!: breaking bug fix`<br>`BREAKING CHANGE: API is now totally different` |
| **æ–°åŠŸèƒ½** | `minor` | `feat: æ·»åŠ æ–°çš„æ’­æ”¾å™¨åŠŸèƒ½`<br>`feat(player): æ·»åŠ è¿›åº¦æ¡` |
| **å…¶ä»–** | `patch` | `fix: ä¿®å¤æ’­æ”¾å´©æºƒé—®é¢˜`<br>`chore: æ›´æ–°ä¾èµ–åº“`<br>`docs: æ›´æ–° README`<br>`style: æ ¼å¼åŒ–ä»£ç `<br>`refactor: é‡æ„éŸ³é¢‘å¤„ç†é€»è¾‘`<br>`test: æ·»åŠ å•å…ƒæµ‹è¯•` |

### æäº¤ç±»å‹è¯´æ˜

- **feat**: æ–°åŠŸèƒ½
- **fix**: Bug ä¿®å¤
- **docs**: æ–‡æ¡£å˜æ›´
- **style**: ä»£ç æ ¼å¼ï¼ˆä¸å½±å“ä»£ç è¿è¡Œçš„å˜åŠ¨ï¼‰
- **refactor**: é‡æ„ï¼ˆæ—¢ä¸æ˜¯æ–°å¢åŠŸèƒ½ï¼Œä¹Ÿä¸æ˜¯ä¿®å¤ bugï¼‰
- **test**: å¢åŠ æµ‹è¯•
- **chore**: æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨
- **perf**: æ€§èƒ½ä¼˜åŒ–
- **ci**: CI é…ç½®æ–‡ä»¶å’Œè„šæœ¬çš„å˜åŠ¨
- **revert**: å›é€€ä¹‹å‰çš„ commit

## ğŸ”„ å·¥ä½œæµç¨‹

### Main åˆ†æ”¯ï¼ˆç”Ÿäº§ç‰ˆæœ¬ï¼‰

```
å¼€å‘è€…æäº¤ä»£ç  â†’ æ¨é€åˆ° main
    â†“
GitHub Actions è§¦å‘ pro-bump workflow
    â†“
åˆ†ææäº¤ä¿¡æ¯ â†’ è®¡ç®—ç‰ˆæœ¬å·
    â†“
æ›´æ–° MARKETING_VERSION
    â†“
åˆ›å»º tag: v1.2.3
    â†“
è‡ªåŠ¨æäº¤ç‰ˆæœ¬å˜æ›´
    â†“
rebase pre å’Œ dev åˆ†æ”¯
```

### Pre åˆ†æ”¯ï¼ˆé¢„å‘å¸ƒç‰ˆæœ¬ï¼‰

```
å¼€å‘è€…æäº¤ä»£ç  â†’ æ¨é€åˆ° pre
    â†“
GitHub Actions è§¦å‘ pre-bump workflow
    â†“
åˆ†ææäº¤ä¿¡æ¯ â†’ è®¡ç®—ç‰ˆæœ¬å·
    â†“
æ›´æ–° MARKETING_VERSION
    â†“
åˆ›å»º tag: p1.2.3
    â†“
è‡ªåŠ¨æäº¤ç‰ˆæœ¬å˜æ›´
    â†“
rebase dev åˆ†æ”¯
```

## ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹

### åœºæ™¯ 1: æ·»åŠ æ–°åŠŸèƒ½

```bash
# æäº¤æ–°åŠŸèƒ½
git commit -m "feat: æ·»åŠ æ’­æ”¾åˆ—è¡¨åŠŸèƒ½"
git push origin main

# è‡ªåŠ¨å‡çº§ç‰ˆæœ¬: 3.1.6 â†’ 3.2.0
# è‡ªåŠ¨åˆ›å»º tag: v3.2.0
```

### åœºæ™¯ 2: ä¿®å¤ Bug

```bash
# æäº¤ bug ä¿®å¤
git commit -m "fix: ä¿®å¤æ’­æ”¾å™¨å´©æºƒé—®é¢˜"
git push origin main

# è‡ªåŠ¨å‡çº§ç‰ˆæœ¬: 3.1.6 â†’ 3.1.7
# è‡ªåŠ¨åˆ›å»º tag: v3.1.7
```

### åœºæ™¯ 3: ç ´åæ€§å˜æ›´

```bash
# æäº¤ç ´åæ€§å˜æ›´
git commit -m "feat!: ç§»é™¤æ—§çš„æ’­æ”¾å™¨ API"
git push origin main

# è‡ªåŠ¨å‡çº§ç‰ˆæœ¬: 3.1.6 â†’ 4.0.0
# è‡ªåŠ¨åˆ›å»º tag: v4.0.0
```

### åœºæ™¯ 4: å¤šä¸ªæäº¤

```bash
# å¤šä¸ªæäº¤
git commit -m "feat: æ·»åŠ å‡è¡¡å™¨"
git commit -m "fix: ä¿®å¤å‡è¡¡å™¨ UI é—®é¢˜"
git commit -m "docs: æ›´æ–°å‡è¡¡å™¨æ–‡æ¡£"
git push origin main

# åªè¦æœ‰ feat: æäº¤ï¼Œå°±å‡çº§ minor ç‰ˆæœ¬
# è‡ªåŠ¨å‡çº§ç‰ˆæœ¬: 3.1.6 â†’ 3.2.0
```

## ğŸ› ï¸ è„šæœ¬è¯´æ˜

### scripts/bump-version.sh

åˆ†ææäº¤å†å²ï¼Œè¾“å‡ºç‰ˆæœ¬å¢é‡ç±»å‹ï¼ˆmajor/minor/patchï¼‰

**ç”¨æ³•ï¼š**
```bash
./scripts/bump-version.sh
```

**è¾“å‡ºï¼š**
```
major | minor | patch
```

### scripts/calculate-version.sh

è®¡ç®—æ–°ç‰ˆæœ¬å·å¹¶æ›´æ–° Xcode é¡¹ç›®æ–‡ä»¶

**ç”¨æ³•ï¼š**
```bash
./scripts/calculate-version.sh
```

**è¾“å‡ºï¼š**
```
3.2.0
```

## ğŸ“š ç›¸å…³èµ„æº

- [Conventional Commits è§„èŒƒ](https://www.conventionalcommits.org/)
- [Semantic Versioning 2.0.0](https://semver.org/lang/zh-CN/)
- [GitHub Actions æ–‡æ¡£](https://docs.github.com/cn/actions)

## ğŸ¨ æœ€ä½³å®è·µ

1. **æäº¤ä¿¡æ¯è¦æ¸…æ™°å‡†ç¡®**
   - ä½¿ç”¨æ­£ç¡®çš„ç±»å‹å‰ç¼€
   - æè¿°è¦ç®€æ´æ˜äº†
   - ç ´åæ€§å˜æ›´è¦ç”¨ `!` æ ‡è®°æˆ–åœ¨ footer ä¸­è¯´æ˜

2. **é¢‘ç¹æäº¤ï¼Œå°æ­¥è¿­ä»£**
   - æ¯ä¸ªæäº¤åªåšä¸€ä»¶äº‹
   - é¿å…è¶…å¤§æäº¤
   - ä¾¿äºå›æ»šå’Œä»£ç å®¡æŸ¥

3. **ä½¿ç”¨æäº¤æ¨¡æ¿**
   - é¡¹ç›®æ ¹ç›®å½•å¯ä»¥åˆ›å»º `.gitmessage` æ¨¡æ¿
   - é…ç½® `git config commit.template .gitmessage`

4. **æäº¤å‰éªŒè¯**
   ```bash
   # æœ¬åœ°æµ‹è¯•è„šæœ¬
   ./scripts/bump-version.sh
   ./scripts/calculate-version.sh
   ```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **ä¸è¦æ‰‹åŠ¨ä¿®æ”¹ç‰ˆæœ¬å·**
   - ç‰ˆæœ¬å·ç”± workflow è‡ªåŠ¨ç®¡ç†
   - æ‰‹åŠ¨ä¿®æ”¹å¯èƒ½ä¼šé€ æˆç‰ˆæœ¬å†²çª

2. **éµå¾ª Conventional Commits**
   - ä¸è§„èŒƒçš„æäº¤ä¼šè¢«é»˜è®¤ä¸º patch
   - å¯èƒ½å¯¼è‡´ç‰ˆæœ¬å·ä¸ç¬¦åˆé¢„æœŸ

3. **æ ‡ç­¾ä¿æŠ¤**
   - main åˆ†æ”¯ä½¿ç”¨ `v` å‰ç¼€ï¼ˆv1.2.3ï¼‰
   - pre åˆ†æ”¯ä½¿ç”¨ `p` å‰ç¼€ï¼ˆp1.2.3ï¼‰

4. **åˆ†æ”¯ç­–ç•¥**
   - main â†’ pre â†’ dev çš„ rebase é¡ºåº
   - é¿å…ç›´æ¥åœ¨ main/pre åˆ†æ”¯å¼€å‘
